<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blicket - Secure Messaging</title>
    <link rel="stylesheet" href="../css/messenger.css">
    <script src="../scripts/messenger.js"></script>
</head>
<body>
<div class="container">
    <header>
        <a href="/" class="logo">B<span>licket</span></a>
        <nav>
            <ul>
                <li><a href="#">Features</a></li>
                <li><a href="#">Security</a></li>
                <li><a href="#">Payments</a></li>
                <li><a href="#">Support</a></li>
            </ul>
        </nav>
    </header>

    <div class="messaging-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-actions">
                    <div class="action-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M18 20C18 17.7909 15.3137 16 12 16C8.68629 16 6 17.7909 6 20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="action-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 12H5M19 12C20.1046 12 21 12.8954 21 14V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V14C3 12.8954 3.89543 12 5 12M19 12V10C19 8.89543 18.1046 8 17 8M5 12V10C5 8.89543 5.89543 8 7 8M7 8V6C7 4.89543 7.89543 4 9 4H15C16.1046 4 17 4.89543 17 6V8M7 8H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="action-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4V4C14.7614 4 17 6.23858 17 9V9C17 11.7614 14.7614 14 12 14V14C9.23858 14 7 11.7614 7 9V9C7 6.23858 9.23858 4 12 4Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M12 14V20" stroke="currentColor" stroke-width="2"/>
                            <path d="M16 18L8 18" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                </div>
            </div>
            <div class="search-bar">
                <input type="text" class="search-input" placeholder="Search or start new chat">
            </div>
            <div id="conversations-list" class="conversations">
                <!-- Conversation items will be dynamically generated here -->
            </div>
        </div>

        <!-- Chat Area -->
        <div class="chat-area">
            <div id="chat-header" class="chat-header">
                <!-- Chat header will be dynamically generated here -->
            </div>
            <div id="messages-container" class="messages">
                <!-- Messages will be dynamically generated here -->
                <div id="empty-state" class="empty-chat-state">
                    <p>Select a conversation to start messaging</p>
                </div>
            </div>
            <div id="message-input-container" class="message-input-container" style="display: none;">
                <div class="input-actions">
                    <div class="input-action">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M8 14C8 14 9.5 16 12 16C14.5 16 16 14 16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M9 9H9.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M15 9H15.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="input-action">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 15V16.2C21 17.8802 21 18.7202 20.673 19.362C20.3854 19.9265 19.9265 20.3854 19.362 20.673C18.7202 21 17.8802 21 16.2 21H7.8C6.11984 21 5.27976 21 4.63803 20.673C4.07354 20.3854 3.6146 19.9265 3.32698 19.362C3 18.7202 3 17.8802 3 16.2V15M17 8L12 3M12 3L7 8M12 3V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div id="payment-action" class="input-action">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 11H5M19 11C20.1046 11 21 11.8954 21 13V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V13C3 11.8954 3.89543 11 5 11M19 11V9C19 7.89543 18.1046 7 17 7M5 11V9C5 7.89543 5.89543 7 7 7M7 7V5C7 3.89543 7.89543 3 9 3H15C16.1046 3 17 3.89543 17 5V7M7 7H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </div>
                <input type="text" id="message-input" class="message-input" placeholder="Type a message...">
                <button id="send-button" class="send-button">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Payment Dialog Template (hidden by default) -->
<div id="payment-dialog-template" style="display: none;">
    <div class="payment-dialog-overlay">
        <div class="payment-dialog">
            <div class="payment-dialog-header">
                <h3>Send QUBIC to <span class="payment-recipient-name"></span></h3>
                <button class="payment-dialog-close">&times;</button>
            </div>
            <div class="payment-dialog-content">
                <div class="payment-input-group">
                    <label for="payment-amount">Amount (QUBIC)</label>
                    <input type="number" id="payment-amount" min="0.01" step="0.01" value="1.00">
                </div>
                <div class="payment-input-group">
                    <label for="payment-note">Note (optional)</label>
                    <input type="text" id="payment-note" placeholder="What's it for?">
                </div>
                <div class="payment-details">
                    <p>Recipient: <span class="payment-recipient-name"></span></p>
                    <p>Your Balance: <span id="user-balance">135.75</span> QUBIC</p>
                </div>
            </div>
            <div class="payment-dialog-actions">
                <button class="payment-cancel">Cancel</button>
                <button class="payment-send">Send Payment</button>
            </div>
        </div>
    </div>
</div>

<!-- Initialize the app with user data -->
<script th:inline="javascript">
    // Current user's name from Thymeleaf
    const currentUser = /*[[${userName}]]*/ 'Noah';

    // API endpoints
    const API_ENDPOINTS = {
        getMessages: '/api/get-messages',
        newMessage: '/api/new-message'
    };
</script>

<!-- Include the messenger JavaScript -->
<script th:src="@{/scripts/messenger.js}"></script>
</body>
</html>